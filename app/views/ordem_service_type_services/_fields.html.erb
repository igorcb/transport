
	<%= hidden_field_tag "ordem_service_type_service[ordem_service_id]", @ordem_service.id if !@ordem_service.nil? %>  
	<%= render 'shared/error_messages', object: f.object %>
  
<!--     
    <div class="col-xs-1">
      <%# value_qtde_recebida = @ordem_service.new_record? ? nil : f.object.qtde_recebida %>
      <%#= f.text_field :qtde_recebida, value: value_qtde_recebida, class: "form-control input-sm", placeholder: "Qtde Recebida" %>
    </div>
 -->
  <div class="form-group">
    <div class="row">
      <div class="col-xs-2">
        <%= label_tag :client_id, "Cliente" %>
        <%= text_field_tag :client_id, @ordem_service.billing_client.id, disabled: false, class: "form-control input-sm" if @ordem_service.billing_client.present? %>
      </div>
      <div class="col-xs-4">
        <%= label_tag :billing_cpf_cpnj, "CNPJ" %>
        <%= text_field_tag :billing_cpf_cpnj, @ordem_service.billing_client.cpf_cnpj, disabled: false, class: "form-control input-sm" if @ordem_service.billing_client.present?  %>
      </div>
    </div>
  </div>

  <div class="form-group">
    <%= label_tag :client_name, "Nome" %>
    <%= text_field_tag :client_name, @ordem_service.billing_client.nome, disabled: false, class: "form-control input-sm" if @ordem_service.billing_client.present?  %>
  </div>

  <div class="form-group">
    <%= f.label :stretch_route_id, "Trecho" %>
    <% if @ordem_service_type_service.stretch_route_id.present? %>
      <%= f.collection_select :stretch_route_id, ordem_service_stretch_route(@ordem_service.billing_client_id), :id, :stretch_source_and_target_long, {prompt: "SELECIONE TRECHO ORIGEM"}, {class: "form-control input-sm"} %>
    <% else %>
      <%= f.collection_select :stretch_route_id, [], :name, :name, {prompt: "SELECIONE TRECHO"}, {class: "form-control input-sm"}  %>
    <% end %>
  </div> 

  <div class="form-group">
    <%= f.label :type_service_id, "Tipo de Servico" %>
    <% if @ordem_service_type_service.type_service_id.present? %>
      <%= f.collection_select :type_service_id, ordem_service_type_service(@ordem_service_type_service.billing_client_id, @ordem_service_type_service.stretch_route_id ), :id, :descricao, {prompt: "SELECIONE TRECHO ORIGEM"}, {class: "form-control input-sm"} %>
    <% else %>
      <%= f.collection_select :type_service_id, [], :id, :name, {prompt: "SELECIONE O SERVICO"}, {class: "form-control input-sm"}  %>
    <% end %>
  </div> 
    
  <div class="form-group">
  	<%= f.label :advance_money_number, "No. Adiantamento" %>
    <%= f.text_field :advance_money_number, class: "form-control input-sm", placeholder: "Nº 000000/2018" %>
  </div>

  <div class="form-group">
  	<%= f.label :valor, "Valor do Serviço" %>
    <%= f.text_field :valor, class: "form-control input-sm money2", value: to_real(f.object.valor), placeholder: "Valor do Serviço" %>
  </div>

<script type="text/javascript">
  $(document).ready(function() {
    $("#billing_cpf_cpnj").focusout(function() {
      var client_id = "cpf_cnpj="+$('#billing_cpf_cpnj').val();
      console.log(client_id);
      $.getJSON('/get_stretch_routes_from_client_cnpj', client_id, function(data){
        var options = '<option value="">SELECIONE O TRECHO</option>'; 
        $.each(data, function(i, item) {
          options += '<option value="' + item.id + '">' + item.n + '</option>';
        });
        $("#ordem_service_type_service_stretch_route_id").html(options);

      });    
    });    
  });
</script>

<script type="text/javascript">
  $(document).ready(function() {
    $("#ordem_service_type_service_stretch_route_id").change(function() {
      var cpf_cnpj = $("#billing_cpf_cpnj").val();
      var stretch_route_id = $("#ordem_service_type_service_stretch_route_id").val();
      var client_and_stretch_route = {'cpf_cnpj': cpf_cnpj, 'stretch_route_id': stretch_route_id}
      console.log(client_and_stretch_route);
      $.getJSON('/get_client_table_price_of_by_client_cnpj_and_stretch_route', client_and_stretch_route, function(data){
        var options = '<option value="">SELECIONE O TIPO DE SERVICO</option>'; 
        $.each(data, function(i, item) {
          options += '<option value="' + item.id + '">' + item.n + '</option>';
        });
        $("#ordem_service_type_service_type_service_id").html(options);
      });
    }); 
  });
</script>
